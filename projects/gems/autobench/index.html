<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta content="Autobench, as follow up to [Autoperf](http://mervine.net/gems/autoperf), was created to allow for benchmarking web pages" name="description">
<meta content="autoperf, httperf, httperfrb, gems, nodejs, phantomjs, rubyautobench release notes" name="keywords">
<meta content="width=device-width, initial-scale=1.0" name="viewport">
<meta content="" name="author">
<link href="//netdna.bootstrapcdn.com/bootswatch/3.0.0/spacelab/bootstrap.min.css" media="screen" rel="stylesheet">
<link href="//cdn.mervine.net/bootstrap/master.css" media="screen" rel="stylesheet">
<!--[if lte IE 6]>
      <link href='http://universal-ie6-css.googlecode.com/files/ie6.1.1.css' media='screen, projection' rel='stylesheet'>
    <![endif]--><!--[if lt IE 9]>
      <script src='//html5shim.googlecode.com/svn/trunk/html5.js'></script>
    <![endif]--><link href="/articles.xml" rel="alternate" type="application/atom+xml">
<link href="//cdn.mervine.net/bootstrap/favicon.ico" rel="shortcut icon">
<link href="//cdn.mervine.net/bootstrap/images/apple-touch-icon.png" rel="apple-touch-icon">
<link href="//cdn.mervine.net/bootstrap/images/apple-touch-icon-72x72.png" rel="apple-touch-icon" sizes="72x72">
<link href="//cdn.mervine.net/bootstrap/images/apple-touch-icon-114x114.png" rel="apple-touch-icon" sizes="114x114">
<title>Autobench [alpha release]</title>
</head>
<body style="padding-top: 10px !important">
    <div class="container">
      <div class="navbar navbar-default navbar-top" style="margin-bottom: 0px !important">
        <div class="navbar-header">
          <button class="navbar-toggle" data-target=".navbar-collapse" data-toggle="collapse" type="button">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">Home</a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
<li class="">
              <a href="http://mervine.net/categories">Category List</a>
            </li>
            <li class="">
              <a href="http://mervine.net/projects">My Projects</a>
            </li>
            <li class="">
              <a href="http://mervine.net/notes">Notes</a>
            </li>
            <li class="">
              <a href="http://mervine.net/hacks">Hacks</a>
            </li>
            <li class="">
              <a href="http://mervine.net/quotes">Quotes</a>
            </li>
            <li class="">
              <a href="http://mervine.net/archive">Archives</a>
            </li>
            <li>
              <a href="https://github.com/jmervine/autobench">Fork me on Github</a>
            </li>
          </ul>
<ul class="nav navbar-nav navbar-right visible-xs">
<li>
              <a href="http://twitter.com/mervinej">Twitter</a>
            </li>
            <li>
              <a href="http://linkedin.com/in/mervinej">Linkedin</a>
            </li>
            <li>
              <a href="http://github.com/jmervine">Github</a>
            </li>
            <li>
              <a href="http://www.gittip.com/jmervine">Gittip</a>
            </li>
          </ul>
</div>
      </div>
      <div class="container">
        <div class="page-header" style="margin-top: 0px !important;">
          <img src="http://www.gravatar.com/avatar/ed808193b8c2c8516715816f90a005b2.jpg?s=75" style="padding:5px 15px 15px; float:left"><a href="http://mervine.net/">
            <h1>mervine.net</h1>
          </a><small>Lessons learned, code written, hacks, etc.</small>
        </div>
      </div>
      <div class="container">
        <div class="col-sm-12 col-md-9">
          <div class="page_content container">
  <div class="page_content">
    <h1>Autobench [alpha release]</h1>

<p><img src="https://badge.fury.io/rb/autobench.png" alt="Gem Version">  <a href="https://travis-ci.org/jmervine/autobench"><img src="https://travis-ci.org/jmervine/autobench.png?branch=master" alt="Build Status"></a></p>

<p>Autobench, as follow up to <a href="http://mervine.net/gems/autoperf">Autoperf</a>, was created to allow for benchmarking web pages
in three different ways.</p>

<ol>
<li>Render Metrics -- using <a href="http://mervine.net/httperf"><code>httperf</code></a> and <a href="http://mervine.net/gems/httperfrb"><code>HTTPerf.rb</code></a>, it
grabs a snapshot of how long it takes to access, (server side) render and download your page. You can set thresholds
in your configuration for almost all of httperf's output. Additionally, if you use
<a href="http://mervine.net/httperf-0-9-1-with-individual-connection-times">my version of httperf</a> you'll get percentile
support as well.</li>
<li>Client Metrics -- using <a href="https://github.com/macbre/phantomas"><code>phantomas</code></a>, a sweet <a href="http://mervine.net/phantomjs">PhantomJS</a>
script that grabs all kinds of useful DOM information from loading your page. See <code>phantomas</code> for more details.</li>
<li>YSlow Metrics -- using <a href="http://yslow.org/phantomjs"><code>yslow.js</code></a>, a <a href="http://mervine.net/phantomjs">PhantomJS</a> script
written to inspect your page and give you all kinds of useful grading and information. See <a href="http://yslow.org">YSlow</a>
for more details.</li>
</ol>
<p>Autobench is based around a pass / fail mentality and let's you set as many or as few thresholds as you would like through
it's extensive, but hopefully simple configuration. You can easily generate a template configuration for your web page by
running <code>autobench-config -o ./path/to/write/config.yml -s example.com -u /path/to/page</code> (see usage notes below for details).</p>

<p>For sample configurations, see: <a href="https://github.com/jmervine/autobench/tree/master/config">github.com/jmervine/autobench/tree/master/config</a>.</p>

<h3>Why Alpha</h3>

<p>Mostly because I haven't use this in thre real world yet. I don't like to final release <a href="http://mervine.net/gems">my gems</a>
until I've had a change to fully vet them in real world senarios. Additionally, I have some additional
features in mind, like being able to pass a padding value in to <code>autobench-config</code> to pad thresholds by
a percentage and perhaps allowing <code>autobench</code> to take a run only flag for benchmarks.</p>

<p>Lastly, and more importantly, I want to make sure it's actually useful. Currently when running autobench,
either via cli or in a test framework, I get a high failure rate do to network latency and other factors.</p>

<p>That said, help me out. Install it, try it, <a href="https://github.com/jmervine/autobench/issues">submit issues</a>
or <a href="https://github.com/jmervine/autobench">fork it</a> and send me pull requests.</p>

<h2>Installation</h2>

<pre class="twilight">gem install autobench --pre
<span class="Comment"><span class="Comment">#</span> or...</span>
bundle init
echo <span class="String"><span class="String">"</span>gem 'autobench', '0.0.1alpha1'<span class="String">"</span></span> <span class="Keyword">&gt;&gt;</span> Gemfile
bundle install --path vendor/bundle
</pre>

<h2>Dependencies</h2>

<p>The following three dependencies must either be in your <code>PATH</code>, or specified in your configuration like so:</p>

<pre class="twilight"><span class="MetaTagAll"><span class="MetaTagInline">paths</span><span class="MetaTagAll">:</span></span>
    <span class="MetaTagAll"><span class="MetaTagInline">httperf</span><span class="MetaTagAll">:</span> </span>/path/to/httperf
    <span class="MetaTagAll"><span class="MetaTagInline">phantomjs</span><span class="MetaTagAll">:</span> </span>/path/to/phantomjs
    <span class="MetaTagAll"><span class="MetaTagInline">node</span><span class="MetaTagAll">:</span> </span>/path/to/node
</pre>

<h4>HTTPerf</h4>

<p>It's recommended that you install <a href="http://mervine.net/httperf-0-9-1-with-individual-connection-times">my version of httperf</a>,
however, if you choose not to, any version will give you most of the thresholds available.</p>

<pre class="twilight"><span class="Comment"><span class="Comment">#</span> Ubuntu</span>
sudo apt-get install httperf
<span class="Comment"><span class="Comment">#</span> CentOS</span>
sudo yum install httperf
<span class="Comment"><span class="Comment">#</span> Mac</span>
sudo port install httperf <span class="Comment"><span class="Comment">#</span> I think? Anyone, confirm!</span>
</pre>

<h4>PhantomJS</h4>

<p>See: <a href="http://phantomjs.org/">phantomjs.org</a>.</p>

<h4>NodeJS</h4>

<p>See: <a href="http://mervine.net/notes/installing-nodejs-from-source">Installing Node.js from Source</a> or <a href="http://nodejs.org/">nodejs.org</a>.</p>

<h2>Usage</h2>

<h3>With <a href="https://github.com/seattlerb/minitest">Minitest</a>
</h3>

<pre class="twilight"><span class="Keyword">require</span> <span class="String"><span class="String">"</span>minitest/autorun<span class="String">"</span></span>
<span class="Keyword">require</span> <span class="String"><span class="String">"</span>autobench<span class="String">"</span></span>

<span class="Keyword">class</span> <span class="Entity">TestBenchmarks<span class="EntityInheritedClass"> <span class="EntityInheritedClass">&lt;</span> Minitest::Test</span></span>
    <span class="Keyword">def</span> <span class="Entity">setup</span>
        <span class="Variable"><span class="Variable">@</span>autobench</span> <span class="Keyword">=</span> <span class="Support">Autobench</span>.<span class="Entity">new</span>(<span class="String"><span class="String">"</span>./config/mervine.yml<span class="String">"</span></span>)
    <span class="Keyword">end</span>
    <span class="Keyword">def</span> <span class="Entity">test_autobench_render</span>
        <span class="Variable"><span class="Variable">@</span>autobench</span>.<span class="Entity">render</span>.<span class="Entity">benchmark</span>
        assert <span class="Variable"><span class="Variable">@</span>autobench</span>.<span class="Entity">render</span>.<span class="Entity">passed?</span>,
            <span class="String"><span class="String">"</span>Passed:<span class="StringConstant">\n</span><span class="StringEmbeddedSource"><span class="StringEmbeddedSource">#{</span><span class="StringVariable"><span class="StringVariable">@</span>autobench</span><span class="StringEmbeddedSource"><span class="StringEmbeddedSource">.</span><span class="Entity">render</span></span><span class="StringEmbeddedSource"><span class="StringEmbeddedSource">.</span><span class="Entity">successes</span></span><span class="StringEmbeddedSource">}</span></span><span class="StringConstant">\n</span>Failed:<span class="StringConstant">\n</span><span class="StringEmbeddedSource"><span class="StringEmbeddedSource">#{</span><span class="StringVariable"><span class="StringVariable">@</span>autobench</span><span class="StringEmbeddedSource"><span class="StringEmbeddedSource">.</span><span class="Entity">render</span></span><span class="StringEmbeddedSource"><span class="StringEmbeddedSource">.</span><span class="Entity">failures</span></span><span class="StringEmbeddedSource">}</span></span><span class="String">"</span></span>
    <span class="Keyword">end</span>
    <span class="Keyword">def</span> <span class="Entity">test_autobench_client</span>
        <span class="Variable"><span class="Variable">@</span>autobench</span>.<span class="Entity">client</span>.<span class="Entity">benchmark</span>
        assert <span class="Variable"><span class="Variable">@</span>autobench</span>.<span class="Entity">client</span>.<span class="Entity">passed?</span>,
            <span class="String"><span class="String">"</span>Passed:<span class="StringConstant">\n</span><span class="StringEmbeddedSource"><span class="StringEmbeddedSource">#{</span><span class="StringVariable"><span class="StringVariable">@</span>autobench</span><span class="StringEmbeddedSource"><span class="StringEmbeddedSource">.</span><span class="Entity">client</span></span><span class="StringEmbeddedSource"><span class="StringEmbeddedSource">.</span><span class="Entity">successes</span></span><span class="StringEmbeddedSource">}</span></span><span class="StringConstant">\n</span>Failed:<span class="StringConstant">\n</span><span class="StringEmbeddedSource"><span class="StringEmbeddedSource">#{</span><span class="StringVariable"><span class="StringVariable">@</span>autobench</span><span class="StringEmbeddedSource"><span class="StringEmbeddedSource">.</span><span class="Entity">client</span></span><span class="StringEmbeddedSource"><span class="StringEmbeddedSource">.</span><span class="Entity">failures</span></span><span class="StringEmbeddedSource">}</span></span><span class="String">"</span></span>
    <span class="Keyword">end</span>
    <span class="Keyword">def</span> <span class="Entity">test_autobench_yslow</span>
        <span class="Variable"><span class="Variable">@</span>autobench</span>.<span class="Entity">yslow</span>.<span class="Entity">benchmark</span>
        assert <span class="Variable"><span class="Variable">@</span>autobench</span>.<span class="Entity">yslow</span>.<span class="Entity">passed?</span>,
            <span class="String"><span class="String">"</span>Passed:<span class="StringConstant">\n</span><span class="StringEmbeddedSource"><span class="StringEmbeddedSource">#{</span><span class="StringVariable"><span class="StringVariable">@</span>autobench</span><span class="StringEmbeddedSource"><span class="StringEmbeddedSource">.</span><span class="Entity">yslow</span></span><span class="StringEmbeddedSource"><span class="StringEmbeddedSource">.</span><span class="Entity">successes</span></span><span class="StringEmbeddedSource">}</span></span><span class="StringConstant">\n</span>Failed:<span class="StringConstant">\n</span><span class="StringEmbeddedSource"><span class="StringEmbeddedSource">#{</span><span class="StringVariable"><span class="StringVariable">@</span>autobench</span><span class="StringEmbeddedSource"><span class="StringEmbeddedSource">.</span><span class="Entity">yslow</span></span><span class="StringEmbeddedSource"><span class="StringEmbeddedSource">.</span><span class="Entity">failures</span></span><span class="StringEmbeddedSource">}</span></span><span class="String">"</span></span>
    <span class="Keyword">end</span>
<span class="Keyword">end</span>
</pre>

<p>See <a href="https://github.com/jmervine/autobench/tree/master/examples">github.com/jmervine/autobench/tree/master/examples</a>
for more test framework examples.</p>

<h3>CLI</h3>

<h4><code>autobench</code></h4>

<pre class="twilight">Usage: autobench [options]

Required Arguments:
    -c, --config FILENAME            configuration file

Optional Arguments:

  Note: server, port, uri and runs overide what's in
  your configuation file.

    -s, --server SERVER              target server
    -p, --port PORT                  target port
    -u, --uri URI                    target uri
    -i, --runs RUNS                  itterations against target
    -f, --format [json|yaml|csv]     raw output format
    -r, --results [dirname]          results directory (default: /tmp)

Module Exclusion:
    -R, --without-render             Do not include render (httperf).
    -Y, --without-yslow              Do not include yslow (yslow.js).
    -C, --without-client             Do not include client (phantomas).

Misc. Arguments:
    -q, --quiet                      Print no things.
    -h, --help                       Show this message
</pre>

<h4><code>autobench-config</code></h4>

<p>The purpose of this is to generate a base configuration for your page, containing
all possible values in their current state.</p>

<blockquote><p>Note: I recommend looking over each configuration and removing those you don't
care about. Also, you should bump most up just a bit to account for standard
network variance.</p></blockquote>

<pre class="twilight">Usage: autobench-config [options]

Required Arguments:
    -o, --output FILENAME            configuration output file

Optional Arguments:

  Note: server, port, uri and runs overide defaults:
  - server: 'localhost'
  - port:   80
  - uri:    '/'
  - runs:   9

    -s, --server SERVER              target server
    -p, --port PORT                  target port
    -u, --uri URI                    target uri
    -i, --runs RUNS                  itterations against target

Module Exclusion:
    -R, --without-render             Do not include render (httperf).
    -Y, --without-yslow              Do not include yslow (yslow.js).
    -C, --without-client             Do not include client (phantomas).

Misc. Arguments:
    -h, --help                       Show this message
</pre>
    <hr class="article_seperator">
<header><h2>Articles on Autobench [alpha release]</h2>
    </header><div class="well" style="padding-top: 0px; padding-bottom: 0px">
      <header><h2>
          <a href="http://mervine.net/projects/gems/autobench-release-notes">Autobench Release - 0.0.1alpha7</a>
        </h2>
      </header><p>Commit Logs for Autobench Release's</p>
      <p class="read_more">
        <a href="http://mervine.net/projects/gems/autobench-release-notes">Continue reading</a>
      </p>
      <footer><p class="meta">
          Published
          on
          <time datetime="2013-07-01T20:00:00+00:00" pubdate>01 July 2013</time>
          in
          <a href="http://mervine.net/projects/gems/autobench">Autobench [alpha release]</a>,
          <a href="http://mervine.net/projects">My Projects</a>,
          <a href="http://mervine.net/ruby">Ruby</a>
        </p>
      </footer>
</div>
    
    <hr class="article_seperator">
<br><div id="disqus_thread">
      <script async src="http://rubyops.disqus.com/embed.js" type="text/javascript"></script><noscript>
        <a href="http://rubyops.disqus.com/embed.js?url=ref">View comments.</a>
      </noscript>
    </div>
  </div>
</div>
        </div>
        <div class="col-md-3 visible-md visible-lg">
          <div class="sidebar-nav">
              <ul class="share-buttons">
<li>
                  <a href="https://www.facebook.com/sharer/sharer.php?u=http://mervine.net/projects/gems/autobench" target="_blank">
                    <img src="//cdn.mervine.net/bootstrap/images/simple_icons/Facebook.png"></a>
                </li>
                <li>
                  <a href="https://twitter.com/intent/tweet?url=http://mervine.net/projects/gems/autobench&amp;text=Autobench%20%5Balpha%20release%5D%20-%20&amp;via=mervinej" target="_blank" title="Tweet">
                    <img src="//cdn.mervine.net/bootstrap/images/simple_icons/Twitter.png"></a>
                </li>
                <li>
                  <a href="https://plus.google.com/share?url=http://mervine.net/projects/gems/autobench" target="_blank" title="Share on Google+">
                    <img src="//cdn.mervine.net/bootstrap/images/simple_icons/Google.png"></a>
                </li>
                <li>
                  <a href="http://www.reddit.com/submit?url=http://mervine.net/projects/gems/autobench&amp;title=Autobench%20%5Balpha%20release%5D" target="_blank" title="Submit to Reddit">
                    <img src="//cdn.mervine.net/bootstrap/images/simple_icons/Reddit.png"></a>
                </li>
                <li>
                  <a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=http://mervine.net/projects/gems/autobench&amp;title=Autobench%20%5Balpha%20release%5D&amp;source=http://mervine.net/projects/gems/autobench" target="_blank" title="Share on LinkedIn">
                    <img src="//cdn.mervine.net/bootstrap/images/simple_icons/LinkedIn.png"></a>
                </li>
              </ul>
<div class="list-group">
                <a class="list-group-item active" href="#">
                  <h4 class="list-group-item-heading">More on This</h4>
                </a>
                <a class="list-group-item" href="/projects/gems/autoperf">Autoperf (w/ HTTPerf.rb)</a>
                <a class="list-group-item" href="/projects/gems/httperfrb">HTTPerf.rb</a>
              </div>
              <div class="list-group">
<a class="list-group-item active" href="http://joshua.mervine.net/">
                  <h4 class="list-group-item-heading">Joshua P. Mervine</h4>
                </a><a class="list-group-item" href="http://twitter.com/mervinej">Twitter</a>
            <a class="list-group-item" href="http://linkedin.com/in/mervinej">Linkedin</a>
            <a class="list-group-item" href="http://github.com/jmervine">Github</a>
            <a class="list-group-item" href="http://www.gittip.com/jmervine">Gittip</a>
              </div>
            </div>
        </div>
      </div>
      <center>
        <br><div id="footer">
            <div class="container">
              <p class="muted credit">
                Powered by Nesta, a
                <a href="http://nestacms.com">Ruby CMS</a>.
              </p>
            </div>
          </div>
      </center>
    </div>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script><script async src="//netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js" type="text/javascript"></script><script>
      var searchElement = 'input[name=q]';
    </script><script async src="//cdn.jsdelivr.net/jquery.webpage-vim/0.1/vim.min.js" type="text/javascript"></script><script type="text/javascript">
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-32343843-1']);
        _gaq.push(['_trackPageview']);
        (function() {
          var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
          ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
          var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
      </script>
</body>
</html>
